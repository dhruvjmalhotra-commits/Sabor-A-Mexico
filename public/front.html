<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Sabor a Mexico – Front Desk</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/style.css" />

  <style>
    body {
      background: #0f172a;
      color: #f8fafc;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    }

    header {
      background: linear-gradient(90deg,#16a34a,#15803d);
      padding: 14px 20px;
      font-size: 20px;
      font-weight: 800;
      border-radius: 0 0 14px 14px;
    }

    .card {
      background: #020617;
      border-radius: 14px;
      padding: 14px;
      margin-bottom: 14px;
      box-shadow: 0 10px 25px rgba(0,0,0,.4);
    }

    .menu-category {
      margin-top: 14px;
    }

    .menu-title {
      font-size: 18px;
      font-weight: 800;
      margin-bottom: 8px;
      color: #22c55e;
    }

    .menu-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px,1fr));
      gap: 10px;
    }

    .menu-btn {
      background: #020617;
      border: 2px solid #1e293b;
      border-radius: 12px;
      padding: 12px;
      text-align: left;
      cursor: pointer;
      transition: all .15s ease;
    }

    .menu-btn:hover {
      border-color: #22c55e;
      transform: scale(1.03);
    }

    .menu-name {
      font-size: 14px;
      font-weight: 700;
    }

    .menu-price {
      font-size: 14px;
      font-weight: 800;
      color: #22c55e;
      margin-top: 4px;
    }

    .total-box {
      font-size: 20px;
      font-weight: 900;
      color: #22c55e;
    }

    input, select, textarea {
      width: 100%;
      padding: 8px;
      border-radius: 8px;
      border: none;
      background: #020617;
      color: #f8fafc;
    }

    button {
      background: #16a34a;
      color: #fff;
      border: none;
      padding: 10px 16px;
      font-size: 15px;
      font-weight: 800;
      border-radius: 10px;
      cursor: pointer;
    }

    button.secondary {
      background: #334155;
    }
  </style>
</head>

<body>
<header>
  Sabor a Mexico • Front Desk
</header>

<main style="padding:14px">

<div class="card">
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
    <input id="createdBy" placeholder="Cashier name" />
    <select id="orderType">
      <option>Takeaway</option>
      <option>Dine-in</option>
      <option>Delivery</option>
    </select>
  </div>
</div>

<div class="card">
  <div style="display:grid;grid-template-columns:1fr 1fr 80px;gap:10px">
    <select id="meatChoice">
      <option value="">Meat</option>
      <option>Steak</option>
      <option>Asada</option>
      <option>Pork</option>
      <option>Al Pastor</option>
      <option>Chorizo</option>
      <option>Birria Chicken</option>
      <option>Barbacoa</option>
    </select>

    <select id="sideChoice">
      <option value="">Side</option>
      <option>Rice</option>
      <option>Fries</option>
      <option>Rice & Beans</option>
      <option>Rice/Fries</option>
    </select>

    <input id="qty" type="number" min="1" value="1"/>
  </div>

  <input id="note" style="margin-top:8px" placeholder="Special note (no onion, spicy, etc)" />
</div>

<div class="card" id="menu"></div>

<div class="card">
  <div id="items"></div>
  <div style="margin-top:10px" class="total-box">
    Total: $<span id="total">0.00</span>
  </div>
  <div style="margin-top:10px">
    <button onclick="sendOrder()">Send to Kitchen</button>
    <button class="secondary" onclick="clearOrder()">Clear</button>
  </div>
</div>

</main>

<script src="/common.js"></script>
<script>
const MENU = [
  {cat:"Birria Specials", items:[
    ["3 Birria Tacos",14.99],
    ["Birria Pizza",19.99],
    ["3 Chicken Birria",14.99]
  ]},
  {cat:"Burritos & Quesadillas", items:[
    ["Quesadilla",14.99],
    ["Quesadilla w/ rice & fries",16.99],
    ["Burrito",14.99],
    ["California Burrito",16.99]
  ]},
  {cat:"Fajitas", items:[
    ["Fajita Plate",14.99]   // ✅ UPDATED
  ]},
  {cat:"Crunchy Favorites", items:[
    ["Nachos",14.99],
    ["Nachos & Cheese",4.99] // ✅ UPDATED
  ]}
];

let order=[];

function renderMenu(){
  const root=document.getElementById("menu");
  root.innerHTML="";
  MENU.forEach(c=>{
    root.innerHTML+=`<div class="menu-category">
      <div class="menu-title">${c.cat}</div>
      <div class="menu-grid">
        ${c.items.map(i=>`
          <div class="menu-btn" onclick="addItem('${i[0]}',${i[1]})">
            <div class="menu-name">${i[0]}</div>
            <div class="menu-price">$${i[1].toFixed(2)}</div>
          </div>`).join("")}
      </div>
    </div>`;
  });
}

function addItem(name,price){
  const qty=+document.getElementById("qty").value||1;
  const note=[document.getElementById("meatChoice").value,
              document.getElementById("sideChoice").value,
              document.getElementById("note").value]
              .filter(Boolean).join(" | ");
  order.push({name,price,qty,note});
  renderItems();
}

function renderItems(){
  const el=document.getElementById("items");
  let total=0;
  el.innerHTML="";
  order.forEach(o=>{
    total+=o.price*o.qty;
    el.innerHTML+=`<div>${o.qty}× ${o.name} ${o.note?`(${o.note})`:""}</div>`;
  });
  document.getElementById("total").textContent=total.toFixed(2);
}

function clearOrder(){
  order=[];
  renderItems();
}

async function sendOrder(){
  if(!order.length)return;
  await api("/api/orders",{
    method:"POST",
    body:JSON.stringify({
      createdBy:createdBy.value||"FrontDesk",
      orderType:orderType.value,
      items:order
    })
  });
  clearOrder();
}
renderMenu();
</script>
</body>
</html>
